# üìä –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π

–ö—Ä–∞—Å–∏–≤–∞—è –≤–µ–±-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–∏–¥–æ–≤ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–π —Å –ª—é–±–æ–≥–æ —Å–∞–π—Ç–∞ –∏–ª–∏ CRM. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ª—é–±—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ API.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
cd server
npm install

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ—Ä—Ç 4000)
npm run dev
```

### 2. –û—Ç–∫—Ä—ã—Ç—å –¥–∞—à–±–æ—Ä–¥
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: **http://localhost:4000**

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìà –ö—Ä–∞—Å–∏–≤—ã–π –¥–∞—à–±–æ—Ä–¥
- **–ö–∞—Ä—Ç–æ—á–∫–∏ KPI**: –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–¥–æ–≤, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, —Ä–∞—Å—Ö–æ–¥, —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- **–§–∏–ª—å—Ç—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞** —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –≤–∞—à–µ–≥–æ Excel —Ñ–∞–π–ª–∞
- **–§–∏–ª—å—Ç—Ä—ã**: –ø–æ –¥–∞—Ç–∞–º, –∏—Å—Ç–æ—á–Ω–∏–∫—É, –≥–æ—Ä–æ–¥—É, –ø—Ä–æ–¥—É–∫—Ç—É
- **–¢—ë–º–Ω–∞—è —Ç–µ–º–∞** —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏

### üìÅ –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- **CSV –∏–º–ø–æ—Ä—Ç**: –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ Excel —Ñ–∞–π–ª ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫
- **API –∑–∞–≥—Ä—É–∑–∫–∞**: –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ —á–µ—Ä–µ–∑ REST API
- **–í–µ–±—Ö—É–∫–∏**: —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ª—é–±—ã—Ö CRM

### üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∞–π—Ç–æ–≤ –∏ CRM

#### 1. CRM —Å–∏—Å—Ç–µ–º—ã (Bitrix24, amoCRM)
1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö CRM –Ω–∞–π–¥–∏—Ç–µ "–í–µ–±—Ö—É–∫–∏" –∏–ª–∏ "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
2. –î–æ–±–∞–≤—å—Ç–µ URL: `http://localhost:4000/api/webhook/bitrix24`
3. CRM –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏–¥—ã –≤ —Å–∏—Å—Ç–µ–º—É

#### 2. –§–æ—Ä–º—ã –Ω–∞ —Å–∞–π—Ç–µ
–î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ —Ñ–æ—Ä–º—ã –Ω–∞ –≤–∞—à–µ–º —Å–∞–π—Ç–µ:
```javascript
// –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã
fetch('http://localhost:4000/api/webhook/forms', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    name: document.querySelector('input[name="name"]').value,
    phone: document.querySelector('input[name="phone"]').value,
    email: document.querySelector('input[name="email"]').value,
    page: window.location.href,
    source: 'website_form'
  })
});
```

#### 3. Google Ads / –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–π —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤–µ–±—Ö—É–∫ –ø—Ä–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.

## üõ† API –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏–¥–æ–≤
```bash
# –û–¥–∏–Ω–æ—á–Ω—ã–π –ª–∏–¥
curl -X POST http://localhost:4000/api/leads \
  -H "Content-Type: application/json" \
  -d '{
    "source": "google Ads",
    "company": "truboprovod", 
    "name": "–ò–ª—å—è",
    "phone": "+77001234567",
    "city": "–ê–ª–º–∞—Ç—ã",
    "conversion": "WhatsApp",
    "spend": 13.55
  }'

# –ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
curl -X POST http://localhost:4000/api/leads \
  -H "Content-Type: application/json" \
  -d '[{...}, {...}]'
```

### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤–µ–±—Ö—É–∫
```bash
curl -X POST http://localhost:4000/api/webhook/bitrix24 \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ò–ª—å—è",
    "phone": "+77001234567", 
    "city": "–ê–ª–º–∞—Ç—ã",
    "keyword": "—Ç—Ä—É–±–∞ —Å—Ç–∞–ª—å–Ω–∞—è",
    "cost": 9.25,
    "event": "WhatsApp"
  }'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–ø–∏—Å–æ–∫ –ª–∏–¥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
GET /api/leads?from=2025-10-01&to=2025-10-03&source=google%20Ads&city=–ê–ª–º–∞—Ç—ã

# –ú–µ—Ç—Ä–∏–∫–∏
GET /api/metrics?from=2025-10-01&to=2025-10-03
```

### CSV –∏–º–ø–æ—Ä—Ç
```bash
curl -X POST http://localhost:4000/api/upload-csv \
  -F "csv=@data.csv"
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|----------|--------|
| `time` | –í—Ä–µ–º—è –ª–∏–¥–∞ | "17:47:46" |
| `phone` | –¢–µ–ª–µ—Ñ–æ–Ω | "+77001234567" |
| `name` | –ò–º—è | "–ò–ª—å—è" |
| `source` | –ò—Å—Ç–æ—á–Ω–∏–∫ | "google Ads", "–Ø–Ω–¥–µ–∫—Å: –î–∏—Ä–µ–∫—Ç" |
| `company` | –ö–æ–º–ø–∞–Ω–∏—è/–ø—Ä–æ–¥—É–∫—Ç | "truboprovod", "black_metal" |
| `group_name` | –ì—Ä—É–ø–ø–∞ –∫–∞–º–ø–∞–Ω–∏–∏ | "otsinkovannaya_truba_klik" |
| `keywords` | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ | "—Ç—Ä—É–±–∞ —Å—Ç–∞–ª—å–Ω–∞—è 25 –º–º" |
| `conversion` | –¢–∏–ø –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ | "WhatsApp", "tel: +7 (727) 312-28-22" |
| `micro_conversion` | –ú–∏–∫—Ä–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è | "–§–∏–ª—å—Ç—Ä", "support/licenses" |
| `micro_clicks` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞ | 3, 4, 2 |
| `city` | –ì–æ—Ä–æ–¥ | "–ê–ª–º–∞—Ç—ã", "–®—ã–º–∫–µ–Ω—Ç" |
| `status` | –°—Ç–∞—Ç—É—Å | (–ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) |
| `amount` | –°—É–º–º–∞ | 0, 1000 |
| `spend` | –†–∞—Å—Ö–æ–¥ | 13.55, 9.25 |

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```env
PORT=4000
CLIENT_DIR=../client
DB_PATH=./data.sqlite
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- SQLite —Ñ–∞–π–ª: `server/data.sqlite`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

## üöÄ –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### Docker
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY server/package*.json ./
RUN npm ci --only=production
COPY server/ ./
COPY client/ ../client/
EXPOSE 4000
CMD ["npm", "start"]
```

### VPS/Render/Fly.io
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js 18+
3. `npm install` –≤ –ø–∞–ø–∫–µ `server`
4. `npm start` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ PM2
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º–µ–Ω –∏ SSL

## üìù –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ `server/src/routes.ts`
2. –î–æ–±–∞–≤—å—Ç–µ –º–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π –¥–ª—è –≤–∞—à–µ–π CRM
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤ –≤ API `/api/connectors`

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è
–î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—É `leads` –∏ –æ–±–Ω–æ–≤–∏—Ç–µ:
- `server/src/db.ts` - —Å—Ö–µ–º–∞ –ë–î
- `server/src/routes.ts` - –º–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π
- `client/app.js` - –∫–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

- [ ] –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º/–∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram/Slack
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel/PDF
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Facebook Ads, VK Ads

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ CRM - –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å.
